:root {
  --bg: #f8fafc;         /* sfondo pagina */
  --panel: #ffffff;      /* pannelli/sfondo tabella */
  --panel-2: #f1f5f9;    /* intestazioni/aree secondarie */
  --text: #111827;       /* testo principale */
  --muted: #6b7280;      /* testo attenuato */
  --accent: #2563eb;     /* pulsanti/azioni */
  --accent-2: #1d4ed8;   /* hover pulsanti */
  --border: #e5e7eb;     /* bordi chiari */
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: var(--bg);
  color: var(--text);
}

.layout { display: grid; grid-template-columns: 240px 1fr; height: 100vh; }

.sidebar {
  background: linear-gradient(180deg, var(--panel), var(--panel-2));
  border-right: 1px solid var(--border);
  padding: 16px 12px;
}
.brand { display: flex; flex-direction: column; align-items: flex-start; gap: 6px; font-weight: 700; letter-spacing: .3px; margin: 4px 8px 16px; }
.brand-logo { max-height: 75px; width: auto; display: block; }
.brand-link { display: inline-flex; align-items: center; }
.brand-name { color: inherit; }
.nav { display: flex; flex-direction: column; gap: 4px; }
.nav-link {
  display: block; padding: 10px 12px; border-radius: 8px; color: var(--text); text-decoration: none;
}
.nav-link:hover { background: #f1f5f9; }
.nav-link.active { background: #e7f0ff; color: #1f2937; border: 1px solid #bfdbfe; }

/* Accordion menu */
.accordion { margin-top: 4px; }
.accordion-header {
  width: 100%; text-align: left; background: transparent; color: var(--text);
  border: 1px solid transparent; border-radius: 8px; padding: 10px 12px; cursor: pointer;
  display: flex; align-items: center; justify-content: space-between;
}
.accordion-header:hover { background: #f1f5f9; }
.accordion-header[aria-expanded="true"] { background: #e7f0ff; border-color: #bfdbfe; }
.accordion .chev { transition: transform .15s ease; }
.accordion-header[aria-expanded="true"] .chev { transform: rotate(90deg); }
.accordion-panel { display: flex; flex-direction: column; gap: 4px; padding-left: 8px; margin-top: 6px; }
.accordion-panel[hidden] { display: none; }
.nav-sublink { display: block; padding: 8px 10px; border-radius: 6px; color: var(--text); text-decoration: none; }
.nav-sublink:hover { background: #f1f5f9; }
.nav-sublink.active { background: #e7f0ff; color: #1f2937; border: 1px solid #bfdbfe; }

.content { padding: 24px; overflow: auto; }
.view { display: none; }
.view.active { display: block; }

h1 { font-size: 20px; margin: 0 0 16px; }
p { color: var(--muted); }

form { display: flex; gap: 12px; align-items: center; margin-top: 8px; }
input[type="file"] { color: var(--text); }
button {
  background: var(--accent);
  color: white; border: 0; border-radius: 8px; padding: 10px 14px; cursor: pointer; font-weight: 600;
}
button:hover { background: var(--accent-2); }

#message { margin-top: 12px; padding: 10px 12px; border-radius: 8px; background: var(--panel-2); border: 1px solid var(--border); color: var(--text); }
#message.success { color: #065f46; border-color: #a7f3d0; background: #ecfdf5; }
#message.error { color: #991b1b; border-color: #fecaca; background: #fef2f2; }
#message.info { color: #1e3a8a; border-color: #bfdbfe; background: #eff6ff; }

/* Tabella firme */
.table-wrap { margin-top: 12px; border: 1px solid var(--border); border-radius: 8px; overflow: auto; background: var(--panel); }
.table { width: 100%; border-collapse: collapse; min-width: 900px; }
.table th, .table td { padding: 10px 12px; border-bottom: 1px solid var(--border); text-align: left; font-size: 14px; }
.table thead th { position: sticky; top: 0; background: var(--panel-2); z-index: 1; }
.table thead th[data-sort] { cursor: pointer; user-select: none; }
.table thead th[data-sort].asc::after { content: ' \25B2'; opacity: .7; }
.table thead th[data-sort].desc::after { content: ' \25BC'; opacity: .7; }
.table tbody tr:hover { background: #f3f4f6; }
.table td:nth-child(1) { width: 80px; }
.table td:nth-child(3), .table td:nth-child(4) { white-space: nowrap; }
.table td:nth-child(6), .table td:nth-child(7) { text-align: right; font-variant-numeric: tabular-nums; }

.pager { display: flex; align-items: center; gap: 12px; margin-top: 12px; }
.btn { background: var(--accent); color: white; border: 0; border-radius: 6px; padding: 8px 12px; cursor: pointer; }
.btn[disabled] { opacity: .5; cursor: not-allowed; }

/* Controls */
.controls { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
.controls select, .filters input { background: #ffffff; color: var(--text); border: 1px solid var(--border); border-radius: 6px; padding: 6px 8px; }
.filters th { background: var(--panel-2); position: sticky; top: 40px; z-index: 1; }
.filters input { width: 100%; }

/* Icon button */
.icon-btn { background: transparent; border: 1px solid var(--border); border-radius: 6px; padding: 6px 8px; cursor: pointer; }
.icon-btn:hover { background: var(--panel-2); }
/* piccolo indicatore info vicino alla data */
.hint { margin-left: 6px; cursor: help; }

/* Modal */
.modal.hidden { display: none; }
.modal { position: fixed; inset: 0; z-index: 50; }
.modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,.4); }
.modal-dialog { position: relative; max-width: 1100px; margin: 6vh auto; background: var(--panel); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,.2); width: calc(100% - 48px); }
.modal-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: var(--panel-2); border-bottom: 1px solid var(--border); }
.modal-body { padding: 16px; }
.modal-close { background: transparent; border: none; font-size: 22px; line-height: 1; cursor: pointer; padding: 4px 8px; }
.muted { color: var(--muted); }

/* Grid and cards for charts */
.grid-2 { display: grid; grid-template-columns: 1fr; gap: 16px; }
@media (min-width: 900px) { .grid-2 { grid-template-columns: 1fr 1fr; } }
.card { border: 1px solid var(--border); border-radius: 10px; background: var(--panel); padding: 16px; }
.card-title { margin: 0 0 12px; font-size: 16px; color: var(--text); }

@media (max-width: 800px) {
  .layout { grid-template-columns: 1fr; }
  .sidebar { position: sticky; top: 0; display: flex; align-items: center; gap: 12px; }
  .nav { flex-direction: row; flex-wrap: wrap; }
}

/* Sidebar in dark mode */
.sidebar { background: linear-gradient(180deg, #111827, #0b1220); border-right-color: #1f2937; color: #e5e7eb; }
.sidebar .brand { color: #e5e7eb; }
.sidebar .nav-link { color: #e5e7eb; }
.sidebar .nav-link:hover { background: #172033; }
.sidebar .nav-link.active { background: #16213a; color: #ffffff; border-color: #1f2b47; }
/* Improve contrast for accordion + sublinks in dark sidebar */
.sidebar .accordion-header { color: #e5e7eb; border-color: transparent; }
.sidebar .accordion-header:hover { background: #172033; }
.sidebar .accordion-header[aria-expanded="true"] { background: #16213a; border-color: #1f2b47; }
.sidebar .nav-sublink { color: #e5e7eb; }
.sidebar .nav-sublink:hover { background: #172033; }
.sidebar .nav-sublink.active { background: #16213a; color: #ffffff; border: 1px solid #1f2b47; }
